# jCrescendo
Accurate Timbral Restoration of Music for Impaired Hearing
---
![image](https://github.com/dbmcclain/jCrescendo/assets/3160577/1803032e-a854-41f9-bc40-1605bfdead1e)

Sensioneural hearing impairment, most commonly caused by aging, noise exposure, over-loud music exposure, etc., affects mostly the higher frequencies of our hearing. That's because those higher frequencies are sensed by cochlear hair cells nearest to the entry window of the cochlea, and hence exposed to the most damaging levels of sound as it gradually dissipates along the length of the cohclea. 

When listening to unassisted music, it sounds very much like I have my head submerged in a swimming pool. Using hearing aids helps for speech cognition, but it does terrible things to music. I once attended a Mozart concert with hearing aids, and halfway through I heard what sounded like a Miles Davis Muted Trumpet - it turned out to be the Oboe. I tore out my hearing aids and have never used them again when listening to music. But I do listen every day, all day long, to music being streamed through my jCrescendo system.

Our hearing is the product of a complex feedback control system comprised of the outer ear, middle ear, cochlea, afferent 8th nerve, spinal chord, brainstem, and higher brain function processing, feeding back to the middle ear and cochlea via the efferent 8th nerve. Our musical hearing arises from the whole of this processing, not just the cochlea.

jCrescendo is the result of more than 20 years of musical hearing research in my laboratory. The "j" of jCrescendo comes from our having used JUCE to produce AudioUnits and VST3 plugins for use in any audio processing application, such as DAWs or intercepting HAL layer processors such as Rogue Amoeba's SoundSource (https://rogueamoeba.com/soundsource/). The DSP processing found in our Crescendo algorith is independent of JUCE. If you download and install JUCE for yourself (https://juce.com), then the code found here should compile directly on any Mac computer for your own use. Otherwise, feel free to discard the two JUCE-centric files and use the DSP processing in your own way.

For most people, simply setting the Brighten control in the lower left is all that you need. Adjust it for yourself until it sounds best to you, then just leave it alone while you stream music and audio through its processing.

For those wanting more rigor, you can freely adjust each of the standard audiology bands to suit yourself. Crescendo is also the only known algorithm that can compensate for the ancillary condition of Hyper-Recruitment (HyperAcusis) and Decruitment. Some people may have a mixture of normal hearing in Bass, normal recruitment in midband frequencies, Hyper-Recruitment near narrowly damaged bands, and Decruitment at the very highest frequencies. 

The number displayed for Brighten corresponds to the dBHL threshold elevation of your hearing at 4 kHz. But all of Crescendo's corrections are performed in loudness space (Phons measure) and do not directly correspond to anything you could accomplish with audio processors such as compressors and equalizers.

Threshold elevation, in dBHL, is what is normally measured in audiology for your hearing. They test at standard frequencies of 250 Hz, 500, 750, 1k, 1.5k, 2k, 3k, 4k, 6k, and 8k, each spaced at half-octave frequencies. These also correspond to approximately 2 zBark spacing.

But while audiology can detect haearing impairment, measured as the threshold elevation needed to be able to just discern a tone at each frequency, there are no direct tests for conditions of hyper-recruitment and decruitment. You get a hint of having hyper-recruitment when you are shown to have a diminished UCL (Uncomfortable Level), but there are no tests in conventional audiology centers for detecting the location in frequency, or degree, of hyper-recruitment. For that you have to adjust for yourself until things sound correct to you.

Hyper-recruitment is often related to a narrow notch on one's hearing. In my case, there is a deep notch (> 90 DBHL) in my left ear near 1250 Hz. I hear a crunchy sort of sound, like walking on loose gravel, whenever I listen to uncorrected female chorus and high string music. Notching 1 kHz by as little as 3 dB shows a remarkable improvement, and boosting by as little as 3 dB shows a marked increase for me. This extreme sensitivity corresponds to the exponent of intermodulation distortion. You can see in the picture above that I found the best setting for myself to be about -4 dB in the 1 kHz band, and -3 dB at 1.5 and 2 kHz. The higher frequencies, for me, show a degree of decruitment - where sounds never seem as loud as they ought to sound. For those highest frequencies I use about +10 dB of decruitment correction.

The proper scientific setup for Crescendo has to determine the dBFS (digital amplitude) corresponding to some measured sound intensity dBSPL. For calibration, set Crescendo to Bypass, then send a 1 kHz tone through your system and measure both the dBSPL (dBSPL Cal setting), and the dBFS (dBFS Cal setting). During setup, send e.g, a -18 dBFS 1 kHz tone and adjust the amplifier to produce 77-83 dBSPL. Record whatever settings you actually used in the Cal settings. Once calibrated, make all further volume level adjustment ahead of Crescendo so that it can know what you are hearing.

Ideally, Crescendo wants to play into spectrally flat output transducers. Make all coloration EQ adjustments ahead of Crescendo processing. If you have strong impairment you may find that you need to attenuate the output from Crescendo to avoid clipping distortion. Make up for that digital attenuation by increasing the output level at your audio amplifier. For myself, having moderately severe impairment, I routinely attenuate the output of Crescdendo by 18-20 dB. That provides sufficient headroom for nearly all music. I also run my audio studio with a nominal -18 dBFS level for the 0 dBVU average loud but comfortable level. 

After calibration, reduce the volume level (ahead of Crescendo) to whatever loudness level you find most comfortable. Crescendo will automatically compensate for the decreased playback volume levels.

Crescendo can be thought of as an 11-channel nonlinear (ski-jump shaped) audio compressor with each band having a different threshold level, dependent on your hearing. Compression is appropriate, instead of simple equalization, because for loud sounds we don't need any help hearing them. And for faint sound levels we need lots of help. A simple EQ can only seem correct at one loudness level. Above that it is too much gain, and below it is too little. A linear compressor, as found in most studios, can only be correct at two loudness levels. In between it is too much gain, and outside of that range it is too little. We need nonlinear compression for our hearing.

We find that most people show a 3.25 dB/zBark slope to their hearing impairment. So once you know what works at 4 kHz, it is easy to compute the settings needed for the other bands. That's exactly what the Brighten control does, and as you move it, the volume sliders in each band move in concert with it. After finding the best Brighten level for yourself, feel free to make finer adjustments to any of the individual bands. The +D/-H adjustment below each slider is for compensation of HyperRecruitment and Decruitment.

Professional audiology claims a measuring accuracy of Â±5 dB. Don't be surprised if your audiology measurements overstate the degree of your impairment. With conditions of strong impairment you would be amazed at what a setting difference of just 1 dB can make. Since the audiologist can only step in increments of 5 dB, they will likely have overstepped the true elevation in order to get you to just hear the test tone.

The settings for Release Fast (34 ms) and Release Slow (155 ms) were found by one of our users who is a professional musician and audio mixing engineer. Those settings, he felt, provided the most accurate rendition of music. Feel free to adjust these to taste. The Attack of the compression is internally fixed to 2 ms, with a 2 ms lookahead and a 10 ms hold.
